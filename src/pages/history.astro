---
import Layout from "../layouts/Layout.astro";
import QRHistoryTable from "../components/QRHistoryTable.astro";
import Header from "../components/Header.astro";

const { cookies, redirect } = Astro;

// Récupérer les tokens d'authentification
const accessToken = cookies.get("sb-access-token");
const refreshToken = cookies.get("sb-refresh-token");

// Vérifier l'authentification
if (!accessToken || !refreshToken) {
  return redirect("/auth/signin?redirect=/history");
}
---

<Layout title="Historique des QR codes - Wipay">
  <div class="min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900">
    <Header />
    
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
      <div class="mb-8">
        <h1 class="text-3xl font-bold text-white">Historique des QR codes</h1>
        <p class="text-gray-300 mt-2">
          Retrouvez tous les QR codes que vous avez générés et réutilisez-les facilement.
        </p>
      </div>
      
      <QRHistoryTable />
    </main>
  </div>
</Layout> 